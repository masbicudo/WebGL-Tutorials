<!DOCTYPE html>
<head>
    <title>#8 Geometry wireframe and normals</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/106/three.min.js"></script>
    <script type="text/javascript" src="custom-geometries.js"></script>
  </head>
<body>
  <h1></h1>
  <div style="display: inline-block;"><canvas id="canvas" style="border:none" width="600" height="800" /></div>
</body>
<script type="text/javascript">
'use strict'

// Note: all geometry functions will be placed
// in the custom-geometry.js file.

document.querySelector('h1').innerText = document.title
main()

function main() {
  const canvas = document.querySelector('#canvas')
  const renderer = new THREE.WebGLRenderer({canvas})

  // camera
  const fov = 75;
  const aspect = canvas.clientWidth/canvas.clientHeight;
  const near = 0.1;
  const far = 10;
  const camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
  camera.position.z = 4;

  // scene
  const scene = new THREE.Scene();

  // geometry
  const geometry = createCylinderGeometry()
  const wireframe = new THREE.WireframeGeometry(createCylinderGeometry())

  // material
  const material = new THREE.LineBasicMaterial({color: 0xFFFFFF});

  // mesh
  const mesh = new THREE.LineSegments(wireframe, material);
  geometry.computeBoundingSphere()
  console.log(geometry.boundingSphere.radius)
  const normal_line_length = geometry.boundingSphere.radius / 4
  const normals = new THREE.VertexNormalsHelper( new THREE.LineSegments(geometry, material), normal_line_length )
  mesh.add(normals)

  // composing scene
  scene.add(mesh);

  // light source
  {
    const color = 0xFFFFFF;
    const intensity = 1;
    const light = new THREE.PointLight(color, intensity, 0, 2);
    light.position.set(-1, 2, 4);
    scene.add(light);
  }

  // rendering scene through the view of the camera
  function render(time) {
    time /= 1000; // convert milliseconds to seconds
  
    mesh.rotation.x = time;
    mesh.rotation.y = time / 2;
    mesh.rotation.y = time / 5;
  
    renderer.render(scene, camera);
  
    requestAnimationFrame(render);
  }
  requestAnimationFrame(render);
}
</script>
